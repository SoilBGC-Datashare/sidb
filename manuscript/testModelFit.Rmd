---
title: "Testing multi models to data "
output: 
  pdf_document:
    latex_engine: xelatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(sidb)
library(SoilR)
rm(list=ls())
```

## Testing multi models to the dataset of SidB database

Here we test three different two-pool model to each individual datasets. 


```{r sidb database, results='hide'}
db=loadEntries(path="~/sidb/data/")
db_flat=flatterSIDb(db)
```

```{r inipairs}
twopp_inipars= c(0.01, 0.001, 0.1)
twops_inipars= c(0.005, 0.00001, 0.1, 0.01)
twopf_inipars= c(0.005, 0.00001, 0.1, 0.01, 0.01)
```

# Dataset `r db[[1]]$citationKey`
The initial corbon is missing
 

\newpage

# Dataset `r db[[3]]$citationKey` 
```{r, results='hide'}
ds3 <- db[[3]]
str(ds3$timeSeries)
plotEntry(ds3)
```


```{r, results='hide'}
iniC_LTV <- ds3$initConditions[1, "carbonMean"]
iniC_UTV <- ds3$initConditions[2, "carbonMean"]
iniC_B <- ds3$initConditions[3, "carbonMean"]
iniC_V <- ds3$initConditions[4, "carbonMean"]

unitC=ds3$initConditions[3, "carbonUnits"]

#Mod1_3 <- twoppFit(timeSeries = ds3$timeSeries[, c(1,2)], initialCarbon = ds3$initConditions)
```

## V2: Dataset `r db[[3]]$citationKey`, Variable `r db[[3]]$variables$V2$name `, site `r ds3$variables$V2$site`
The initial amount of carbon is `r iniC_LTV` `r unitC`
```{r V2 LTV}
# Variable1
Mod1_32=twoppFit(timeSeries = ds3$timeSeries[, c(1,2)], initialCarbon = iniC_LTV*1e5, inipars =twopp_inipars)
#Mod2_32=twopsFit(timeSeries = ds3$timeSeries[, c(1,2)], initialCarbon = iniC_LTV*1e5, inipars = twops_inipars)
Mod3_32=twopfFit(timeSeries = ds3$timeSeries[, c(1,2)], initialCarbon = iniC_LTV*1e5, inipars = twopf_inipars)
```

```{r}
days32=Mod1_32$SoilRmodel@times
Mlist32=list(Mod1_32, Mod3_32)
Rs32=sapply(Mlist32, function(x){rowSums(getReleaseFlux(x$SoilRmodel))})
```

```{r}
modelNames32=c("Two-pool parallel", "Two-pool feedback")
Rt32=lapply(Mlist32, function(x){getReleaseFlux(x$SoilRmodel)})
```


```{r}
par(mfrow=c(1,2))
for(i in c(1,2)){
  matplot(days32, Rt32[[i]], type="l", lty = 1, ylab = ds3$variables$V2$units, xlab="Day", 
          main=modelNames32[i])
  points(ds3$timeSeries[, c(1,2)], pch=19, cex=0.5)
}
par(mfrow=c(1,1))

ds3$variables$V2
```

## V3: Dataset `r db[[3]]$citationKey`, Variable `r ds3$variables$V3$name`, site `r ds3$variables$V3$site`
```{r V3 Upper Taylor Valley UTV}
Mod1_33=twoppFit(timeSeries = ds3$timeSeries[,c(1,3)], initialCarbon = iniC_UTV*1e5, inipars = twopp_inipars)
Mod2_33=twopsFit(timeSeries = ds3$timeSeries[, c(1,3)], initialCarbon = iniC_UTV*1e5, inipars = twops_inipars)
#Mod3_33=twopfFit(timeSeries = ds3$timeSeries[, c(1,3)], initialCarbon = iniC_UTV*1e5, inipars = twopf_inipars)
# DLSODA-  Warning..Internal T (=R1) and H (=R2) are
#       such that in the machine, T + H = T on the next step  
#      (H = step size). Solver will continue anyway.
# In above message, R1 = 0, R2 = 0
#  
# DINTDY-  T (=R1) illegal      
# In above message, R1 = 0.224449
#  
#       T not in interval TCUR - HU (= R1) to TCUR (=R2)      
# In above message, R1 = 0, R2 = 0
#  
# DINTDY-  T (=R1) illegal      
# In above message, R1 = 0.448898
#  
#       T not in interval TCUR - HU (= R1) to TCUR (=R2)      
# In above message, R1 = 0, R2 = 0
#  
# DLSODA-  Trouble in DINTDY.  ITASK = I1, TOUT = R1
# In above message, I1 = 1
#  
# In above message, R1 = 0.448898
```


```{r}
days33=Mod1_33$SoilRmodel@times
Mlist33=list(Mod1_33, Mod2_33)
Rs33=sapply(Mlist33, function(x){rowSums(getReleaseFlux(x$SoilRmodel))})
```

```{r}
modelNames33=c("Two-pool parallel", "Two-pool series")
Rt33=lapply(Mlist33, function(x){getReleaseFlux(x$SoilRmodel)})
```


```{r}
par(mfrow=c(1,2))
for(i in c(1,2)){
  matplot(days33, Rt33[[i]], type="l", lty = 1, ylab=ds3$variables$V3$units, xlab = "Day", 
          main=modelNames33[i])
  points(ds3$timeSeries[, c(1,2)], pch=19, cex=0.5)
}
par(mfrow=c(1,1))
```

## V4: Dataset `r db[[3]]$citationKey`, Variable `r ds3$variables$V4$name`, site `r ds3$variables$V4$site`
```{r V4 Beacon}
Mod1_34=twoppFit(timeSeries = ds3$timeSeries[,c(1,4)], initialCarbon = iniC_B*1e5, inipars = twopp_inipars)
#Mod2_34=twopsFit(timeSeries = ds3$timeSeries[, c(1,4)], initialCarbon = iniC_B*1e5, inipars = twops_inipars)
#Mod3_34=twopfFit(timeSeries = ds3$timeSeries[, c(1,4)], initialCarbon = iniC_B*1e5, inipars = twopf_inipars)
```



## V5: Dataset `r db[[3]]$citationKey`, Variable `r ds3$variables$V5$name`, site `r ds3$variables$V5$site`
```{r V5 Victoria}

Mod1_35=twoppFit(timeSeries = ds3$timeSeries[,c(1,4)], initialCarbon = iniC_B*1e5, inipars = twopp_inipars)
#Mod2_35=twopsFit(timeSeries = ds3$timeSeries[, c(1,4)], initialCarbon = iniC_B*1e5, inipars = twops_inipars)
#Mod3_35=twopfFit(timeSeries = ds3$timeSeries[, c(1,4)], initialCarbon = iniC_B*1e5, inipars = twopf_inipars)
```


\newpage

# Dataset `r db[[4]]$citationKey` 

This is the results of a depth-warming experiment with two levels of Control and warming. The dataset has 9 column of time, three depth on each warming and control. The variables V3, V5, V7, V9, V11 and V15 are the sd. 
```{r, results='hide'}
ds4 <- db[[4]]
str(ds4$timeSeries)
isCumulative(data.frame(ds4$timeSeries$time,  ds4$timeSeries$control_7.5_15_mean) )
ds4$initConditions
plotEntry(db[[4]])
```

```{r iniC dataset 4}
iniC_C7.5=ds4$initConditions[1, "carbonMean"]
iniC_C20=ds4$initConditions[2,"carbonMean"]
iniC_C50=ds4$initConditions[3,"carbonMean"]
iniC_W7.5=ds4$initConditions[4, "carbonMean"]
iniC_W20=ds4$initConditions[5, "carbonMean"]
iniC_W50=ds4$initConditions[6, "carbonMean"]
```


## V1: Dataset `r db[[4]]$citationKey`, variable `r ds4$variables$V2$name`, site `r ds4$variables$V2$temperature`, depth `r ds4$variables$V2$midDepth`  
```{r}
Mod1_42=twoppFit(timeSeries = ds4$timeSeries[, c(1,2)], initialCarbon =iniC_C7.5*1e5 , inipars = twopp_inipars)
Mod2_42=twopfFit(timeSeries = ds4$timeSeries[, c(1,2)], initialCarbon =iniC_C7.5*1e5 , inipars = twopf_inipars)
Mod3_42=twopsFit(timeSeries = ds4$timeSeries[, c(1,2)], initialCarbon =iniC_C7.5*1e5 , inipars = twops_inipars)
```

## V4: Dataset `r db[[4]]$citationKey`, variable `r ds4$variables$V4$name`, site `r ds4$variables$V4$temperature`, depth `r ds4$variables$V4$midDepth` 
```{r}
Mod1_44=twoppFit(timeSeries = ds4$timeSeries[, c(1,4)], initialCarbon =iniC_C20*1e5 , inipars = twopp_inipars)
Mod2_44=twopfFit(timeSeries = ds4$timeSeries[, c(1,4)], initialCarbon =iniC_C20*1e5 , inipars = twopf_inipars)
Mod3_44=twopsFit(timeSeries = ds4$timeSeries[, c(1,4)], initialCarbon =iniC_C20*1e5 , inipars = twops_inipars)
```

## V6: Dataset `r db[[4]]$citationKey`, variable `r ds4$variables$V6$name`, site `r ds4$variables$V6$temperature`, depth `r ds4$variables$V6$midDepth` 
```{r}
Mod1_46=twoppFit(timeSeries = ds4$timeSeries[, c(1,6)], initialCarbon =iniC_C50*1e5 , inipars = twopp_inipars)
#Mod2_46=twopfFit(timeSeries = ds4$timeSeries[, c(1,6)], initialCarbon =iniC_C50*1e5 , inipars = twopf_inipars)
Mod3_46=twopsFit(timeSeries = ds4$timeSeries[, c(1,6)], initialCarbon =iniC_C50*1e5 , inipars = twops_inipars)
```


## V8: Dataset `r db[[4]]$citationKey`, variable `r ds4$variables$V8$name`, site `r ds4$variables$V8$temperature`, depth `r ds4$variables$V8$midDepth` 
```{r}
Mod1_48=twoppFit(timeSeries = ds4$timeSeries[, c(1,8)], initialCarbon =iniC_C7.5*1e5 , inipars = twopp_inipars)
Mod2_48=twopfFit(timeSeries = ds4$timeSeries[, c(1,8)], initialCarbon =iniC_C7.5*1e5 , inipars = twopf_inipars)
Mod3_48=twopsFit(timeSeries = ds4$timeSeries[, c(1,8)], initialCarbon =iniC_C7.5*1e5 , inipars = twops_inipars)
```

## V10: Dataset `r db[[4]]$citationKey`, variable `r ds4$variables$V10$name`, site `r ds4$variables$V10$temperature`, depth `r ds4$variables$V10$midDepth` 
```{r}
Mod1_410=twoppFit(timeSeries = ds4$timeSeries[, c(1,10)], initialCarbon =iniC_C20*1e5 , inipars = twopp_inipars)
Mod2_410=twopfFit(timeSeries = ds4$timeSeries[, c(1,10)], initialCarbon =iniC_C20*1e5 , inipars = twopf_inipars)
#Mod3_410=twopsFit(timeSeries = ds4$timeSeries[, c(1,10)], initialCarbon =iniC_C20*1e5 , inipars = twops_inipars)
```
## V12: Dataset `r db[[4]]$citationKey`, variable `r ds4$variables$V12$name`, site `r ds4$variables$V12$temperature`, depth `r ds4$variables$V12$midDepth` 
```{r}
Mod1_412=twoppFit(timeSeries = ds4$timeSeries[, c(1,12)], initialCarbon =iniC_C50*1e5 , inipars = twopp_inipars)
#Mod2_412=twopfFit(timeSeries = ds4$timeSeries[, c(1,12)], initialCarbon =iniC_C50*1e5 , inipars = twopf_inipars)
Mod3_412=twopsFit(timeSeries = ds4$timeSeries[, c(1,12)], initialCarbon =iniC_C50*1e5 , inipars = twops_inipars)
```

<!---
\newpage

# Dataset `r db[[6]]$citationKey` 

A dataset with 41 variables of `r db_flat$vars$BradleyCook2016[1, "incDesc"] ` in three levels of depth (10, 30, 40)

This dataset is too short. Only 6 observation
```{r, results='hide'}
ds6 <- db[[6]]
str(ds6$timeSeries)
isCumulative(data.frame(ds6$timeSeries$time,  ds6$timeSeries$SG_40_4.5) )
 plotEntry(db[[6]]) 
```

```{r, results= 'hide'}
db[[6]]$citationKey
ds6$initConditions
isCumulative(data.frame(ds6$timeSeries$time, ds6$timeSeries$SG_40_4.5) )
```

```{r, results='hide'}
iniC_G10=ds6$initConditions[1, "carbonMean"]
iniC_G30=ds6$initConditions[2, "carbonMean"]
iniC_S10=ds6$initConditions[3, "carbonMean"]
iniC_S30=ds6$initConditions[4, "carbonMean"]
```

## V2: Dataset `r db[[6]]$citationKey`, variable `r ds6$variables$V2$name`, site `r ds6$variables$V2$temperature`, depth `r ds6$variables$V2$midDepth` 

Time series is too short for two-pool feedback model and two-pool series model 
```{r}
Mod1_62=twoppFit(timeSeries = ds6$timeSeries[, c(1,2)], initialCarbon =iniC_G10*1e5 , inipars = twopp_inipars)
#Mod2_62=twopfFit(timeSeries = ds6$timeSeries[, c(1,2)], initialCarbon =iniC_G10*1e5 , inipars = twopf_inipars)
Mod3_62=twopsFit(timeSeries = ds6$timeSeries[, c(1,2)], initialCarbon =iniC_G10*1e5 , inipars = twops_inipars)
```
## V3: Dataset `r db[[6]]$citationKey`, variable `r ds6$variables$V3$name`, site `r ds6$variables$V3$temperature`, depth `r ds6$variables$V3$midDepth` 
```{r}
Mod1_63=twoppFit(timeSeries = ds6$timeSeries[, c(1,3)], initialCarbon =iniC_G10*1e5 , inipars = twopp_inipars)
#Mod2_63=twopfFit(timeSeries = ds6$timeSeries[, c(1,3)], initialCarbon =iniC_G10*1e5 , inipars = twopf_inipars)
Mod3_63=twopsFit(timeSeries = ds6$timeSeries[, c(1,3)], initialCarbon =iniC_G10*1e5 , inipars = twops_inipars)
```

--->

\newpage

# Dataset `r db[[9]]$citationKey` 

A dataset with 79 variables of `r db_flat$vars$Crow2019a[1, "incDesc"] ` 

```{r, results='hide'}
ds9 <- db[[9]]
str(ds9$timeSeries)
isCumulative(data.frame(ds9$timeSeries$time,  ds9$timeSeries$Site01) )
plotEntry(db[[9]])
```

## V2: Dataset `r db[[9]]$citationKey`, variable `r ds9$variables$V2$name`, site `r ds9$variables$V2$site`
```{r}
Mod1_92=twoppFit(timeSeries = ds9$timeSeries[, c(1,2)], initialCarbon =ds9$initConditions[1, "carbonMean"]*1e5 , inipars = twopp_inipars)
#Mod2_92=twopfFit(timeSeries = ds9$timeSeries[, c(1,2)], initialCarbon =ds9$initConditions[1, "carbonMean"]*1e5 , inipars = twopf_inipars)
Mod3_92=twopsFit(timeSeries = ds9$timeSeries[, c(1,2)], initialCarbon =ds9$initConditions[1, "carbonMean"]*1e5 , inipars = twops_inipars)
```

## V3: Dataset `r db[[9]]$citationKey`, variable `r ds9$variables$V3$name`, site `r ds9$variables$V3$site`
```{r}
Mod1_93=twoppFit(timeSeries = ds9$timeSeries[, c(1,3)], initialCarbon =ds9$initConditions[2, "carbonMean"]*1e5 , inipars = twopp_inipars)
Mod2_93=twopfFit(timeSeries = ds9$timeSeries[, c(1,3)], initialCarbon =ds9$initConditions[2, "carbonMean"]*1e5 , inipars = twopf_inipars)
Mod3_93=twopsFit(timeSeries = ds9$timeSeries[, c(1,3)], initialCarbon =ds9$initConditions[2, "carbonMean"]*1e5 , inipars = twops_inipars)
```


## V4: Dataset `r db[[9]]$citationKey`, variable `r ds9$variables$V4$name`, site `r ds9$variables$V4$site`
```{r}
Mod1_94=twoppFit(timeSeries = ds9$timeSeries[, c(1,4)], initialCarbon =ds9$initConditions[3, "carbonMean"]*1e5 , inipars = twopp_inipars)
#Mod2_94=twopfFit(timeSeries = ds9$timeSeries[, c(1,4)], initialCarbon =ds9$initConditions[3, "carbonMean"]*1e5 , inipars = twopf_inipars)
Mod3_94=twopsFit(timeSeries = ds9$timeSeries[, c(1,4)], initialCarbon =ds9$initConditions[3, "carbonMean"]*1e5 , inipars = twops_inipars)
```


<!---
\newpage

# Dataset `r db[[11]]$citationKey` 

A dataset with 36 variables of `r db_flat$vars$Dalias2001b[1, "incDesc"] ` , `r db[[11]]$incubationInfo$incDesc` 

** not a soil respiration data base** (Percentage of initially applied C14 remaining over time of incubation)
```{r, results='hide'}
ds11 <- db[[11]]
str(ds11$timeSeries)
isCumulative(data.frame(ds11$timeSeries$time,  ds11$timeSeries$C14_Vin_30) )
plotEntry(db[[11]])
```


```{r, results='hide'}
iniC_Vin=ds11$initConditions[1, "carbonMean"]
iniC_Hal=ds11$initConditions[2, "carbonMean"]
iniC_WalOf=ds11$initConditions[3, "carbonMean"]
iniC_WalOh=ds11$initConditions[4, "carbonMean"]
iniC_ThOh=ds11$initConditions[5, "carbonMean"]
iniC_ThA1=ds11$initConditions[6, "carbonMean"]
iniC_LaA1=ds11$initConditions[7, "carbonMean"]
```


## V2: Dataset `r db[[11]]$citationKey`, variable `r ds11$variables$V2$name`, site `r ds11$variables$V2$site`, temperature `r ds11$variabels$V2$temperature`
```{r}
Mod1_112=twoppFit(timeSeries = ds11$timeSeries[, c(1,2)], initialCarbon =iniC_Vin*1e5 , inipars = twopp_inipars)
Mod2_112=twopfFit(timeSeries = ds11$timeSeries[, c(1,2)], initialCarbon =iniC_Vin*1e5, inipars = twopf_inipars)
Mod3_112=twopsFit(timeSeries = ds11$timeSeries[, c(1,2)], initialCarbon =iniC_Vin*1e5, inipars = twops_inipars)
```

---> 

<!---
\newpage

# Dataset `r db[[12]]$citationKey` 

A dataset with 73 variables of `r db_flat$vars$Doetterl2015[1, "incDesc"] ` , 24 sites with 3 replicate per each site. 

**dataset is too short. 7 observation **

```{r, results='hide'}
ds12 <- db[[12]]
str(ds12$timeSeries)
isCumulative(data.frame(ds12$timeSeries$time,  ds12$timeSeries$SDC22_TSO_1) )
plot(ds12$timeSeries$time, ds12$timeSeries$SDC22_TSO_1)
plotEntry(db[[12]])
```


## V2: Dataset `r db[[12]]$citationKey`, variable `r ds12$variables$V2$name`, site `r ds12$variables$V2$site` replicate 1
```{r}
plot(ds12$timeSeries$time, ds12$timeSeries$SDC22_TSO_1)
# 
# Mod1_122=twoppFit(timeSeries = ds12$timeSeries[, c(1,2)], initialCarbon =ds12$initConditions[1, "carbonMean"]*1e5 , inipars = twopp_inipars)
# Mod2_122=twopfFit(timeSeries = ds12$timeSeries[, c(1,2)], initialCarbon =ds12$initConditions[1, "carbonMean"]*1e5, inipars = twopf_inipars)
#Mod3_122=twopsFit(timeSeries = ds12$timeSeries[, c(1,2)], initialCarbon =ds12$initConditions[1, "carbonMean"]*1e5, inipars = twops_inipars)
```




## V5: Dataset `r db[[12]]$citationKey`, variable `r ds12$variables$V5$name`, site `r ds12$variables$V5$site` replicate 1
```{r}
# Mod1_125=twoppFit(timeSeries = ds12$timeSeries[, c(1,5)], initialCarbon =ds12$initConditions[2, "carbonMean"]*1e5 , inipars = twopp_inipars)
# Mod2_125=twopfFit(timeSeries = ds12$timeSeries[, c(1,5)], initialCarbon =ds12$initConditions[2, "carbonMean"]*1e5, inipars = twopf_inipars)
# Mod3_125=twopsFit(timeSeries = ds12$timeSeries[, c(1,5)], initialCarbon =ds12$initConditions[2, "carbonMean"]*1e5, inipars = twops_inipars)
```
---> 

\newpage

# Dataset `r db[[15]]$citationKey` 

A dataset with 37 variables of `r db_flat$vars$Haddix2011SSSJA[1, "incDesc"] ` 6 different sites each two levels of vegetation (Native grassland and cultivated). and three levels of temperature (15, 25, 35) 

```{r, results='hide'}
ds15 <- db[[15]]
str(ds15$timeSeries)
isCumulative(data.frame(ds15$timeSeries$time,  ds15$timeSeries$C_SasNG_15) )
plotEntry(db[[15]])
```



```{r iniC Haddix2011SSSJA}
iniC_SasNG=ds15$initConditions[1, "carbonMean"] # carbon unit g/kg V2, V3, V4
iniC_SasCul=ds15$initConditions[2, "carbonMean"] #V5, V6, V7

iniC_BrzPas=ds15$initConditions[12, "carbonMean"]
```

## V2: Dataset `r db[[15]]$citationKey`, variable `r ds15$variables$V2$name`, site `r ds15$variables$V2$site` , Vegetation `r ds15$variables$V2$vegetation`,temperature `r ds15$variables$V2$temperature`
```{r}
Mod1_152=twoppFit(timeSeries = ds15$timeSeries[, c(1,2)], initialCarbon =iniC_SasNG*1e5 , inipars = twopp_inipars)
Mod2_152=twopfFit(timeSeries = ds15$timeSeries[, c(1,2)], initialCarbon =iniC_SasNG*1e5, inipars = twopf_inipars)
#Mod3_152=twopsFit(timeSeries = ds15$timeSeries[, c(1,2)], initialCarbon =iniC_SasNG*1e5, inipars = twops_inipars)
```

## V3: Dataset `r db[[15]]$citationKey`, variable `r ds15$variables$V3$name`, site `r ds15$variables$V3$site` , Vegetation `r ds15$variables$V3$vegetation`,temperature `r ds15$variables$V3$temperature`

```{r}
Mod1_153=twoppFit(timeSeries = ds15$timeSeries[, c(1,3)], initialCarbon =iniC_SasNG*1e5 , inipars = twopp_inipars)
Mod2_153=twopfFit(timeSeries = ds15$timeSeries[, c(1,3)], initialCarbon =iniC_SasNG*1e5, inipars = twopf_inipars)
Mod3_153=twopsFit(timeSeries = ds15$timeSeries[, c(1,3)], initialCarbon =iniC_SasNG*1e5, inipars = twops_inipars)
```

## V4: Dataset `r db[[15]]$citationKey`, variable `r ds15$variables$V4$name`, site `r ds15$variables$V4$site` , Vegetation `r ds15$variables$V4$vegetation`,temperature `r ds15$variables$V4$temperature`

```{r}
Mod1_154=twoppFit(timeSeries = ds15$timeSeries[, c(1,4)], initialCarbon =iniC_SasNG*1e5 , inipars = twopp_inipars)
#Mod2_154=twopfFit(timeSeries = ds15$timeSeries[, c(1,4)], initialCarbon =iniC_SasNG*1e5, inipars = twopf_inipars)
Mod3_154=twopsFit(timeSeries = ds15$timeSeries[, c(1,4)], initialCarbon =iniC_SasNG*1e5, inipars = twops_inipars)
```


## V5: Dataset `r db[[15]]$citationKey`, variable `r ds15$variables$V5$name`, site `r ds15$variables$V5$site` , Vegetation `r ds15$variables$V5$vegetation`,temperature `r ds15$variables$V5$temperature`

```{r}
Mod1_155=twoppFit(timeSeries = ds15$timeSeries[, c(1,5)], initialCarbon =iniC_SasCul*1e5 , inipars = twopp_inipars)
Mod2_155=twopfFit(timeSeries = ds15$timeSeries[, c(1,5)], initialCarbon =iniC_SasCul*1e5, inipars = twopf_inipars)
Mod3_155=twopsFit(timeSeries = ds15$timeSeries[, c(1,5)], initialCarbon =iniC_SasCul*1e5, inipars = twops_inipars)
```


## V6: Dataset `r db[[15]]$citationKey`, variable `r ds15$variables$V6$name`, site `r ds15$variables$V6$site` , Vegetation `r ds15$variables$V6$vegetation`,temperature `r ds15$variables$V6$temperature`

```{r}
Mod1_156=twoppFit(timeSeries = ds15$timeSeries[, c(1,6)], initialCarbon =iniC_SasCul*1e5 , inipars = twopp_inipars)
#Mod2_156=twopfFit(timeSeries = ds15$timeSeries[, c(1,6)], initialCarbon =iniC_SasCul*1e5, inipars = twopf_inipars)
Mod3_156=twopsFit(timeSeries = ds15$timeSeries[, c(1,6)], initialCarbon =iniC_SasCul*1e5, inipars = twops_inipars)
```



## V37: Dataset `r db[[15]]$citationKey`, variable `r ds15$variables$V37$name`, site `r ds15$variables$V37$site` , Vegetation `r ds15$variables$V37$vegetation`,temperature `r ds15$variables$V37$temperature`

```{r}
Mod1_1537=twoppFit(timeSeries = ds15$timeSeries[, c(1,37)], initialCarbon =iniC_BrzPas*1e5 , inipars = twopp_inipars)
#Mod2_1537=twopfFit(timeSeries = ds15$timeSeries[, c(1,37)], initialCarbon =iniC_BrzPas*1e5, inipars = twopf_inipars)
Mod3_1537=twopsFit(timeSeries = ds15$timeSeries[, c(1,37)], initialCarbon =iniC_BrzPas*1e5, inipars = twops_inipars)
```



\newpage
# Dataset `r db[[19]]$citationKey` 

A dataset with 14 variables of `r db_flat$vars$NeffHooper2002[1, "incDesc"] ` 6 different soil types

```{r, results='hide'}
db[[19]]$citationKey
ds19 <- db[[19]]
str(ds19$timeSeries)
isCumulative(data.frame(ds19$timeSeries$time,  ds19$timeSeries$CO2_Fair_30) )
plotEntry(ds19)
```


## V2: Dataset of `r db[[19]]$citationKey` variable `r ds19$variables$V2$varDesc` measures as CO2 `r ds19$variables$V2$units` 

```{r V2 CO2_fair30}
iniC_Fair=ds19$initConditions[1, "carbonMean"]  #unit %
Mod1_192=twoppFit(timeSeries = ds19$timeSeries[, c(1,2)], initialCarbon =iniC_Fair*1e5 , inipars = twopp_inipars)
Mod2_192=twopfFit(timeSeries = ds19$timeSeries[, c(1,2)], initialCarbon =iniC_Fair*1e5, inipars = twopf_inipars)
#Mod3_192=twopsFit(timeSeries = ds19$timeSeries[, c(1,2)], initialCarbon =iniC_Fair*1e5, inipars = twops_inipars)
```



## V3: Dataset of `r db[[19]]$citationKey` variable `r ds19$variables$V3$varDesc` measures as CO2 `r ds19$variables$V3$units` 

```{r V3 CO2Chan30}
iniC_Chan=ds19$initConditions[3, "carbonMean"]  #unit %
Mod1_193=twoppFit(timeSeries = ds19$timeSeries[, c(1,3)], initialCarbon =iniC_Chan*1e5 , inipars = twopp_inipars)
Mod2_193=twopfFit(timeSeries = ds19$timeSeries[, c(1,3)], initialCarbon =iniC_Chan*1e5, inipars = twopf_inipars)
#Mod3_193=twopsFit(timeSeries = ds19$timeSeries[, c(1,3)], initialCarbon =iniC_Chan*1e5, inipars = twops_inipars)
```


## V4: Dataset of `r db[[19]]$citationKey` variable `r ds19$variables$V4$varDesc` measures as CO2 `r ds19$variables$V4$units` 

```{r V4 CO2Too30}
iniC_Too=ds19$initConditions[4, "carbonMean"]  #unit %
Mod1_194=twoppFit(timeSeries = ds19$timeSeries[, c(1,4)], initialCarbon =iniC_Too*1e5 , inipars = twopp_inipars)
Mod2_194=twopfFit(timeSeries = ds19$timeSeries[, c(1,4)], initialCarbon =iniC_Too*1e5, inipars = twopf_inipars)
Mod3_194=twopsFit(timeSeries = ds19$timeSeries[, c(1,4)], initialCarbon =iniC_Too*1e5, inipars = twops_inipars)
```



\newpage
# Dataset `r db[[22]]$citationKey` 

A dataset with 25 variables of `r db_flat$vars$Rey2008EJSS[1, "incDesc"] ` 8  different study sites, 3 different depth  (midDepth: 2.5, 7.5, 15). 58 observation

```{r, results='hide'}
db[[22]]$citationKey
ds22 <- db[[22]]
str(ds22$timeSeries)
isCumulative(data.frame(ds22$timeSeries$time,  ds22$timeSeries$CMin_Hain_0_5) )
plotEntry(ds22)
```


## V2: Dataset of `r db[[22]]$citationKey` variable `r ds22$variables$V2$varDesc` measures as CO2 `r ds22$variables$V2$units` 

```{r V2 Min Hain}
iniC_Ha2.5=ds22$initConditions[13, "carbonMean"]  #unit %
Mod1_222=twoppFit(timeSeries = ds22$timeSeries[, c(1,2)], initialCarbon =iniC_Ha2.5*1e5 , inipars = twopp_inipars)
Mod2_222=twopfFit(timeSeries = ds22$timeSeries[, c(1,2)], initialCarbon =iniC_Ha2.5*1e5, inipars = twopf_inipars)
Mod3_222=twopsFit(timeSeries = ds22$timeSeries[, c(1,2)], initialCarbon =iniC_Ha2.5*1e5, inipars = twops_inipars)
```



## V3: Dataset of `r db[[22]]$citationKey` variable `r ds22$variables$V3$varDesc` measures as CO2 `r ds22$variables$V3$units` 

```{r V3 Min Hain}
iniC_Ha7.5=ds22$initConditions[14, "carbonMean"]  #unit %
Mod1_222=twoppFit(timeSeries = ds22$timeSeries[, c(1,3)], initialCarbon =iniC_Ha7.5*1e5 , inipars = twopp_inipars)
Mod2_222=twopfFit(timeSeries = ds22$timeSeries[, c(1,3)], initialCarbon =iniC_Ha7.5*1e5, inipars = twopf_inipars)
Mod3_222=twopsFit(timeSeries = ds22$timeSeries[, c(1,3)], initialCarbon =iniC_Ha7.5*1e5, inipars = twops_inipars)
```


\newpage
# Dataset `r db[[24]]$citationKey` 

A dataset with 17 variables of `r db_flat$vars$Sierra2017BG[1,"incDesc"] `, two levels of temperature, 4 levels of soil moisture and 2 levels of oxygen as treatments


```{r, results='hide'}
db[[24]]$citationKey
ds24 <- db[[24]]
str(ds24$timeSeries)
isCumulative(data.frame(ds24$timeSeries$time,  ds24$timeSeries$TMO_25_15_20) )
plotEntry(ds24)
```


## V2: Dataset of `r db[[24]]$citationKey` variable `r ds24$variables$V2$varDesc` measures as CO2 `r ds24$variables$V2$units` 

```{r}
iniC_ds24=ds24$initConditions[1, "carbonMean"]  #unit mg/mg 
Mod1_242=twoppFit(timeSeries = ds24$timeSeries[, c(1,2)], initialCarbon =iniC_ds24*1000, inipars = twopp_inipars)
#Mod2_242=twopfFit(timeSeries = ds24$timeSeries[, c(1,2)], initialCarbon =iniC_ds24*1000, inipars = twopf_inipars)
#Mod3_242=twopsFit(timeSeries = ds24$timeSeries[, c(1,2)], initialCarbon =iniC_ds24*1000, inipars = twops_inipars)
```



\newpage
# Dataset `r db[[25]]$citationKey` 

A dataset with 16 variables of `r db_flat$vars$Song2010EJSOB[1,"incDesc"] `.

** The dataset is short ** only 7 observation
```{r, results='hide'}
db[[25]]$citationKey
ds25 <- db[[25]]
str(ds25$timeSeries)
isCumulative(data.frame(ds25$timeSeries$time,  ds25$timeSeries$CO2_Cr_5) )
plotEntry(ds25)
```


\newpage
# Dataset `r db[[27]]$citationKey` 

A dataset with 16 variables of `r db_flat$vars$Townsend1997[1,"incDesc"] `.

** The dataset is short ** only 6 observation
```{r, results='hide'}
db[[27]]$citationKey
ds27 <- db[[27]]
str(ds27$timeSeries)
isCumulative(data.frame(ds27$timeSeries$time,  ds27$timeSeries$CO2_Pas100_20) )
plotEntry(ds27)
```



\newpage
# Dataset `r db[[28]]$citationKey` 

A dataset with 16 variables of `r db_flat$vars$Wang2010[1,"incDesc"] `.

** The dataset is short ** only 7 observation
```{r, results='hide'}
db[[28]]$citationKey
ds28 <- db[[28]]
str(ds28$timeSeries)
isCumulative(data.frame(ds28$timeSeries$time,  ds28$timeSeries$CO2_5_10_20_0) )
plotEntry(ds28)
```



\newpage
# Dataset `r db[[30]]$citationKey` 

A dataset with 13 variables of `r db_flat$vars$Winkler1996[1,"incDesc"] `. 15 observation

```{r, results='hide'}
db[[30]]$citationKey
ds30 <- db[[30]]
str(ds30$timeSeries)
isCumulative(data.frame(ds30$timeSeries$time,  ds30$timeSeries$CO2_38_A) )
plotEntry(ds30)
```


## V2: Dataset of `r db[[30]]$citationKey` variable `r ds30$variables$V2$varDesc` measures as CO2 `r ds30$variables$V2$units` 

```{r}
iniC_DF14=ds30$initConditions[1, "carbonMean"]  #unit percent
Mod1_302=twoppFit(timeSeries = ds30$timeSeries[, c(1,2)], initialCarbon =iniC_DF14*1e5, inipars = twopp_inipars)
Mod2_302=twopfFit(timeSeries = ds30$timeSeries[, c(1,2)], initialCarbon =iniC_DF14*1e5, inipars = twopf_inipars)
Mod3_302=twopsFit(timeSeries = ds30$timeSeries[, c(1,2)], initialCarbon =iniC_DF14*1e5, inipars = twops_inipars)
```



\newpage
# Dataset `r db[[31]]$citationKey` 

A dataset with 13 variables of `r db_flat$vars$Winkler1996[1,"incDesc"] `. 15 observation

```{r, results='hide'}
db[[31]]$citationKey
ds31 <- db[[31]]
str(ds31$timeSeries)
isCumulative(data.frame(ds31$timeSeries$time,  ds31$timeSeries$CO2_u20_PP) )
plotEntry(ds31)
```

## V2: Dataset of `r db[[31]]$citationKey` variable `r ds31$variables$V2$varDesc` measures as CO2 `r ds31$variables$V2$units` 

```{r}
iniC_PP=ds31$initConditions[1, "carbonMean"]  #unit percent
Mod1_312=twoppFit(timeSeries = ds31$timeSeries[, c(1,2)], initialCarbon =iniC_PP*1e5, inipars = twopp_inipars)
#Mod2_312=twopfFit(timeSeries = ds31$timeSeries[, c(1,2)], initialCarbon =iniC_PP*1e5, inipars = twopf_inipars)
Mod3_312=twopsFit(timeSeries = ds31$timeSeries[, c(1,2)], initialCarbon =iniC_PP*1e5, inipars = twops_inipars)
```
